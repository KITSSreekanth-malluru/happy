--SELECT S3.PROFILE_ID, S2.ORDER_ID, S3.STATE, S1.PREFIX FROM DCSPP_SHIP_ADDR S1, DCSPP_ORDER_SG S2, DCSPP_ORDER S3 WHERE S1.SHIPPING_GROUP_ID = S2.SHIPPING_GROUPS AND S2.ORDER_ID = S3.ORDER_ID AND (S1.PREFIX NOT IN ('MISS', 'MR', 'ORGANIZATION', 'MRS') OR S1.PREFIX IS NULL) AND S3.STATE <> 'INCOMPLETE';
--SELECT B3.PROFILE_ID, B2.ORDER_ID, B3.STATE, B1.PREFIX FROM DCSPP_BILL_ADDR B1, DCSPP_ORDER_PG B2, DCSPP_ORDER B3 WHERE B1.PAYMENT_GROUP_ID = B2.PAYMENT_GROUPS AND B2.ORDER_ID = B3.ORDER_ID AND (B1.PREFIX NOT IN ('MISS', 'MR', 'ORGANIZATION', 'MRS') OR B1.PREFIX IS NULL) AND B3.STATE <> 'INCOMPLETE';

UPDATE DCSPP_SHIP_ADDR S1 SET S1.PREFIX = 'organization' WHERE EXISTS (SELECT * FROM DCSPP_ORDER_SG S2, DCSPP_ORDER S3 WHERE S1.SHIPPING_GROUP_ID = S2.SHIPPING_GROUPS AND S2.ORDER_ID = S3.ORDER_ID AND (S1.PREFIX NOT IN ('miss', 'mr', 'organization', 'mrs') OR S1.PREFIX IS NULL) AND S3.STATE <> 'INCOMPLETE');
UPDATE DCSPP_BILL_ADDR B1 SET B1.PREFIX = 'organization' WHERE EXISTS (SELECT * FROM DCSPP_ORDER_PG B2, DCSPP_ORDER B3 WHERE B1.PAYMENT_GROUP_ID = B2.PAYMENT_GROUPS AND B2.ORDER_ID = B3.ORDER_ID AND (B1.PREFIX NOT IN ('miss', 'mr', 'organization', 'mrs') OR B1.PREFIX IS NULL) AND B3.STATE <> 'INCOMPLETE');